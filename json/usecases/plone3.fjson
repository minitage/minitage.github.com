{"body": "<div class=\"section\" id=\"a-plone3-project-with-relstorage-postgresql-and-varnish2-support\">\n<h1>A plone3 project with relstorage (postgresql) and varnish2 support<a class=\"headerlink\" href=\"#a-plone3-project-with-relstorage-postgresql-and-varnish2-support\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>First some variables:</p>\n<div class=\"highlight-python\"><pre>export prefix=/somewhere\nexport python=$prefix/python\nexport minitage=$prefix/minitage\nexport ins=$minitage/zope/plony\nexport paster=$mt/bin/paster</pre>\n</div>\n<p>Bootstrap python:</p>\n<div class=\"highlight-python\"><pre>mkdir -p $python\ncd $python\nwget http://git.minitage.org/git/minitage/shell/plain/PyBootstrapper.sh\nbash ./PyBootstrapper.sh $python</pre>\n</div>\n<p>Make a minitage instance:</p>\n<div class=\"highlight-python\"><pre>$python/bin/virtualenv --no-site-packages $minitage\nsource $minitage/bin/activate\neasy_install -U minitage.core minitage.paste\nminimerge -s</pre>\n</div>\n<p>Create and install a <strong>plone3 with RelsSorage project</strong> with the <strong>varnish2</strong> and <strong>postgresql</strong> profiles on top of it:</p>\n<div class=\"highlight-python\"><pre>$paster create -t minitage.plone3 plony with_psycopg2=yes mode=relstorage\nminimerge plony\n$paster create -t minitage.instances.varnish2 plony\n$paster create -t minitage.instances.postgresql plony</pre>\n</div>\n<p>Launch the varnish if you want (you may edit the VCL in $ins/sys/etc/varnish before):</p>\n<div class=\"highlight-python\"><pre>cd $mt/zope/plony\n$ins/sys/etc/init.d/plony-varnish2 restart\n$ins/sys/etc/init.d/postgresql_plony.plony restart\n$ins/bin/instance fg</pre>\n</div>\n<p>You can verify that you have things in the db:</p>\n<div class=\"highlight-python\"><pre>$sys/bin/plony.psql</pre>\n</div>\n<p>Play around and when your are ready, just version in this way:</p>\n<blockquote>\n<ul class=\"simple\">\n<li>$mt/category/project      -&gt; <a class=\"reference external\" href=\"http://url/buildouts/$category/plony\">http://url/buildouts/$category/plony</a></li>\n<li>$mt/minilays/yourproject  -&gt; <a class=\"reference external\" href=\"http://url/minilays/plony\">http://url/minilays/plony</a></li>\n</ul>\n</blockquote>\n<p>Of course, here category is zope.</p>\n<p>Don&#8217;t forget to adapt the <cite>src_uri</cite> or your minibuild:</p>\n<div class=\"highlight-python\"><pre>[minibuild]\n...\nsrc_uri=http://url/buildouts/$category/plony\n...</pre>\n</div>\n</div>\n", "display_toc": false, "title": "A plone3 project with relstorage (postgresql) and varnish2 support", "sourcename": "usecases/plone3.txt", "customsidebar": null, "current_page_name": "usecases/plone3", "next": {"link": "../deploying_a_cas_server/", "title": "Install a project with a CAS server wired on an OpenLDAP backend"}, "rellinks": [["genindex", "General Index", "I", "index"], ["usecases/deploying_a_cas_server", "Install a project with a CAS server wired on an OpenLDAP backend", "N", "next"], ["usecases/install25", "Installation with a python 2.5", "P", "previous"]], "meta": {}, "parents": [{"link": "../", "title": "Minitage in the daily use of a developer"}], "sidebars": ["searchbox.html", "globaltoc.html"], "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">A plone3 project with relstorage (postgresql) and varnish2 support</a></li>\n</ul>\n", "prev": {"link": "../install25/", "title": "Installation with a python 2.5"}, "metatags": ""}